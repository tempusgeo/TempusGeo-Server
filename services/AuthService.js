const dataManager = require('./DataManager'); class AuthService { async adminLogin(identifier, password) { const clients = dataManager.CACHE.clients; let client = clients.find(c => (c.email === identifier || c.id === identifier) && c.password === password); if (!client) return { success: false, error: 'Incorrect credentials' }; const config = await dataManager.getCompanyConfig(client.id); return { success: true, companyId: client.id, config, role: 'admin' }; } } module.exports = new AuthService();
